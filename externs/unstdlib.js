// Unstdlib.js - Copyright 2011 Andrey Petrov <andrey.petrov@shazow.net> (MIT Licensed)
var binary_search=function(a,b,c){var d=0,f=a.length;if(c){for(;d<f;){var e=d+f>>1;c(a[e],b)?d=e+1:f=e}return c(a[d],b)?d:~d}else{for(;d<f;)e=d+f>>1,a[e]<b?d=e+1:f=e;return a[d]==b?d:~d}},binary_insert=function(a,b,c){c=binary_search(a,b,c);c<0&&(c=~c);a.splice(c,0,b);return c},binary_remove=function(a,b,c){b=binary_search(a,b,c);return b>=0?a.splice(b,1)[0]:!1};function draw_grid_to_ctx(a,b,c){b.fillStyle="rgb(255,255,255)";iter_box(c,function(c){a[c[0]][c[1]]&&b.fillRect(c[0],c[1],1,1)})}function ctx_xy_to_rgb(a,b){var c=a.getImageData(b[0],b[1],1,1);return[c.data[0],c.data[1],c.data[2]]};function Cycle(a){var b=0,c=a.length;return function(){b==c&&(b=0);return a[b++]}}function CounterCallback(a,b){return function(){--a==0&&b()}}function inverse_lookup(a){var b={},c;for(c in a)b[a[c]]=c;return b};function in_boundary(a,b){return a[0]>=b[0]&&a[1]>=b[1]&&a[0]<=b[2]&&a[1]<=b[3]}function in_radius(a,b,c){var d=a[0]-b[0],a=a[1]-b[1];return c*c>=d*d+a*a}function boundary_center(a){return[a[0]-(a[0]-a[2])/2,a[1]-(a[1]-a[3])/2]}function bounding_square(a,b){return[a[0],a[1]+b,a[1],a[1]+b]}function rotate(a,b){var c=a[0],d=a[1],f=Math.sin(b),e=Math.cos(b);return[c*e-d*f,c*f+d*e]}
function make_grid(a,b){for(var c=[],d=0,f=a[0];d<f;d++){for(var e=[],g=0,h=a[1];g<h;g++)e.push(b([d,g]));c.push(e)}return c}function make_grid_fast(a,b){for(var c=[],d=a[1]-1,f=a[0]-1;f>=0;f--){for(var e=[],g=d;g>=0;g--)e.push(b);c.push(e)}return c}function iter_box(a,b){for(var c=a[1],d=a[2],f=a[3],e=a[0];e<d;e++)for(var g=c;g<f;g++)b([e,g])}
function iter_line(a,b,c){var d=a[0],f=b[0],e=a[1],g=b[1],h=Math.abs(g-e)>Math.abs(f-d);h&&(d=a[1],e=a[0],f=b[1],g=b[0]);d>f&&(a=d,d=f,f=a,a=e,e=g,g=a);var a=f-d,b=Math.abs(g-e),i=a/2,j=-1;e<g&&(j=1);for(g=f;d<=g;d++){f=h?c([e,d]):c([d,e]);if(f==!1)return!1;i-=b;i<0&&(e+=j,i+=a)}}function flat_3d_idx(a,b){return b[0]*a[0]*a[2]+b[1]*a[2]+b[2]};
